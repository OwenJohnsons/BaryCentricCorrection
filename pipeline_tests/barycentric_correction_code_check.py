import pylab as plt
from blimpy import Waterfall as wf
import os 

os.system("../BaryCentricCorrection/barycentre_seti pVelInc.fil -verbose > pVelInc_bary.fil")
os.system("../BaryCentricCorrection/barycentre_seti pVelDec.fil -verbose > pVelDec_bary.fil")
os.system("../BaryCentricCorrection/barycentre_seti nVelInc.fil -verbose > nVelInc_bary.fil")
os.system("../BaryCentricCorrection/barycentre_seti nVelDec.fil -verbose > nVelDec_bary.fil")


#########
file1 = "nVelInc_bary.fil"
'''
> bary PK 14:29:42.9 -61:59:53.8 982.0 0
58602.5748379630
 58602.5750321437
 58602.5752263245
 58602.5754205052
 58602.5756146859
 58602.5758088667
 58602.5760030474
 58602.5761972282
 58602.5763914089
 58602.5765855896
 58602.5767797704
 58602.5769739511
 58602.5771681319
 58602.5773623126
 58602.5775564933
 58602.5777506741

output was save to 'test' file

> awk '{printf "%.7f,\t",$4}' test
'''
nVelInc_bary = [981.9751610,	981.9751620,	981.9751630,	981.9751640,	981.9751650,	981.9751660,	981.9751670,	981.9751680,	981.9751690,	981.9751700,	981.9751710,	981.9751710,	981.9751720,	981.9751730,	981.9751740,	981.9751750]

time = [i*16.777216 for i in range(0,16)]
obs=wf(file1)
plt.figure(1)
obs.plot_waterfall(f_start=981.9751,f_stop=981.9752)
plt.plot(nVelInc_bary,time,color='red')

############
file2 = "nVelDec_bary.fil"

'''
> bary PK 14:29:42.9 -61:59:53.8 982.0 0
58603.0748379630
 58603.0750321437
 58603.0752263245
 58603.0754205052
 58603.0756146860
 58603.0758088667
 58603.0760030474
 58603.0761972282
 58603.0763914089
 58603.0765855897
 58603.0767797704
 58603.0769739512
 58603.0771681319
 58603.0773623126
 58603.0775564934
 58603.0777506741

> awk '{printf "%.7f,\t",$4}' test1
'''

nVelDec_bary = [981.9758250,	981.9758240,	981.9758240,	981.9758230,	981.9758230,	981.9758220,	981.9758220,	981.9758210,	981.9758210,	981.9758200,	981.9758190,	981.9758190,	981.9758180,	981.9758180,	981.9758170,	981.9758170]

plt.figure(2)
obs1=wf(file2)
obs1.plot_waterfall(f_start=981.97576,f_stop=981.9759)
plt.plot(nVelDec_bary,time,color='red')

##########

file3 = "pVelInc_bary.fil"

'''
bary PK 14:29:42.9 10:59:53.8 982.0 0
58602.5748379630
 58602.5750321437
 58602.5752263245
 58602.5754205052
 58602.5756146859
 58602.5758088667
 58602.5760030474
 58602.5761972282
 58602.5763914089
 58602.5765855896
 58602.5767797704
 58602.5769739511
 58602.5771681319
 58602.5773623126
 58602.5775564933
 58602.5777506741


'''

pValInc_bary = [982.0100700,	982.0100710,	982.0100730,	982.0100750,	982.0100770,	982.0100790,	982.0100800,	982.0100820,	982.0100840,	982.0100860,	982.0100880,	982.0100900,	982.0100910,	982.0100930,	982.0100950,	982.0100970]

plt.figure(3)
obs3=wf(file3)
obs3.plot_waterfall(f_start=982.0100,f_stop=982.0102)
plt.plot(pValInc_bary,time,color='red')

######

file4 = "pVelDec_bary.fil"

'''
bary PK 14:29:42.9 10:59:53.8 982.0 0
58603.0748379630
 58603.0750321437
 58603.0752263245
 58603.0754205052
 58603.0756146860
 58603.0758088667
 58603.0760030474
 58603.0761972282
 58603.0763914089
 58603.0765855897
 58603.0767797704
 58603.0769739512
 58603.0771681319
 58603.0773623126
 58603.0775564934
 58603.0777506741

'''

pVelDec_bary = [982.0110370,	982.0110360,	982.0110350,	982.0110340,	982.0110320,	982.0110310,	982.0110300,	982.0110290,	982.0110270,	982.0110260,	982.0110250,	982.0110240,	982.0110230,	982.0110210,	982.0110200,	982.0110190]

plt.figure(4)
obs4=wf(file4)
obs4.plot_waterfall(f_start=982.0109,f_stop=982.0111)
plt.plot(pVelDec_bary,time,color='red')

#####
plt.show()
